для миграций использовался пакет https://github.com/rubenv/sql-migrate.
Ограничения по тестовому заданию решил сделать на стороне бд, т.к. может быть запущено несколько экземпляров сервиса
